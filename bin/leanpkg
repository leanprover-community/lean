#!/usr/bin/env sh

if command -v realpath >/dev/null 2>&1; then
     REALPATH=realpath
else
     unamestr=`uname`
     # OS X
     if [[ "$unamestr" == 'Darwin' ]]; then
         echo "Cannot find 'realpath' command, please install 'realpath'. If you use 'brew', you can install 'realpath' using 'brew install coreutils'"
         exit 1
     else
         REALPATH="readlink -f"
     fi
fi

leandir=$(dirname "$($REALPATH "$0")")/..
leandir=$($REALPATH "$leandir")

librarydir="$leandir/lib/lean"
test -d "$librarydir" || librarydir="$leandir"

LEAN_PATH=$librarydir/library:$librarydir/leanpkg \
  PATH=$leandir/bin:$PATH \
  exec lean --run "$librarydir/leanpkg/leanpkg/main.lean" "$@"
